version: 3.0.{build}
branches:
  only:
    - master
image:
  - Visual Studio 2022
  - macos-monterey
  - Ubuntu2204
platform: x64
environment:
  nodejs_version: "22"
install:
  - ps: |
      if ($env:OS -eq "Windows_NT") {
        Install-Product node $env:nodejs_version
        npm install --global --production windows-build-tools
        npm install -g yarn
        yarn install
      }
  - sh: |
      if [ "$env:OS" != "Windows_NT" ]; then
        . $HOME/.nvm/nvm.sh
        nvm install $env:nodejs_version
        npm install -g yarn
        yarn install
      fi
build_script:
  - ps: if ($env:OS -eq "Windows_NT") { yarn dist }
  - sh: if [ "$env:OS" != "Windows_NT" ]; then yarn dist; fi
artifacts:
  - path: dist/*.exe
  - path: dist/*.dmg
  - path: dist/*.AppImage
test: false
